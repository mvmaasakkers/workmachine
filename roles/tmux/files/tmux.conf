# =============================================================================
# Terminal Settings (Cross-platform: Linux + macOS)
# =============================================================================

# Use tmux-256color for modern terminal features
# NOTE: Do NOT override TERM in Alacritty - leave it as 'alacritty'
set -g default-terminal "tmux-256color"

# True color (RGB) support for Alacritty and other modern terminals
set -ag terminal-overrides ",alacritty:RGB"
set -ag terminal-overrides ",xterm-256color:RGB"

# Undercurl support (for Neovim diagnostics with wavy underlines)
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
# Underscore colors (colored underlines in Neovim)
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# =============================================================================
# General Settings
# =============================================================================

# Start window numbering at 1
set -g base-index 1
set -g renumber-windows on

set -g mouse on

# Prevent tmux from auto-renaming windows
set -g automatic-rename off
set -g allow-rename off

# Faster command sequences (important for Neovim)
set -s escape-time 10

# Increase scrollback buffer
set -g history-limit 50000

# Focus events for Neovim autoread
set -g focus-events on

# =============================================================================
# Clipboard Configuration (Cross-platform via OSC 52)
# =============================================================================

# Enable OSC 52 clipboard (copy/paste over SSH, works on Linux + macOS)
# No platform-specific tools needed (no pbcopy/xclip dependencies)
set -s set-clipboard on

# Enhanced clipboard support for modern terminals (tmux 3.2+)
set -as terminal-features ',alacritty:clipboard'
set -as terminal-features ',xterm-256color:clipboard'

# =============================================================================
# Vi-mode Copy Bindings
# =============================================================================

setw -g mode-keys vi

# Enter copy mode with prefix + [
# Begin selection with 'v', copy with 'y'
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi C-v send -X rectangle-toggle

# Status bar at top (keeps it away from nvim statusline at bottom)
set -g status-position top

# Catppuccin theme configuration
set -g @catppuccin_flavor "frappe"
set -g @catppuccin_window_status_style "rounded"
set -g @catppuccin_window_text " #W"
set -g @catppuccin_window_current_text " #W"

# Load catppuccin
run ~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux

# Status line configuration
set -g status-right-length 100
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_application}"
set -ag status-right "#{E:@catppuccin_status_session}"

