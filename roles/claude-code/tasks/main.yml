---
- name: Install Claude Code CLI globally via npm
  community.general.npm:
    name: "@anthropic-ai/claude-code"
    global: true
    state: present
  become: true
  when: not ansible_check_mode

- name: Verify Claude Code CLI installation
  ansible.builtin.command: claude --version
  register: claude_version_output
  changed_when: false

- name: Display Claude Code CLI version
  ansible.builtin.debug:
    msg: "Claude Code CLI installed: {{ claude_version_output.stdout }}"
  when: not ansible_check_mode and claude_version_output.stdout | length > 0
